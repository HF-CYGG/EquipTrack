# EquipTrack - ä¼ä¸šçº§ç‰©èµ„è¿½è¸ªä¸ç®¡ç†ç³»ç»Ÿ

> [!TIP]
> **EquipTrack** æ˜¯ä¸€å¥—ç°ä»£åŒ–çš„å…¨æ ˆç‰©èµ„ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œä¸“ä¸ºä¼ä¸šå’Œç»„ç»‡è®¾è®¡ï¼Œæ—¨åœ¨è§£å†³è®¾å¤‡èµ„äº§ç®¡ç†æ··ä¹±ã€å€Ÿè¿˜è®°å½•ä¸é€æ˜ã€å®¡æ‰¹æµç¨‹ç¹çç­‰ç—›ç‚¹ã€‚

---

## ğŸ“Š ç³»ç»Ÿå¯è§†åŒ–æ¦‚è§ˆ (System Visualization)

### 1. ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾ (Architecture)
æœ¬ç³»ç»Ÿé‡‡ç”¨ç»å…¸çš„å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œé€šè¿‡ RESTful API è¿›è¡Œé€šä¿¡ã€‚åç«¯é‡‡ç”¨è½»é‡çº§æ–‡ä»¶å­˜å‚¨æ–¹æ¡ˆï¼Œæ˜“äºéƒ¨ç½²å’Œè¿ç§»ã€‚

```mermaid
graph TD
    User[ğŸ‘¤ ç”¨æˆ·] -->|æ“ä½œç•Œé¢| Client[ğŸ“± Android å®¢æˆ·ç«¯]
    Client -->|REST API (JSON)| Gateway[ğŸŒ API ç½‘å…³ / Express]
    
    subgraph "åç«¯æœåŠ¡å™¨ (Node.js)"
        Gateway --> Auth[ğŸ” è®¤è¯æœåŠ¡]
        Gateway --> Inventory[ğŸ“¦ åº“å­˜æœåŠ¡]
        Gateway --> Workflow[ğŸ”„ å®¡æ‰¹æµå¼•æ“]
        Gateway --> FileMgr[ğŸ“ æ–‡ä»¶ç®¡ç†å™¨]
    end
    
    subgraph "æ•°æ®æŒä¹…å±‚ (Local Storage)"
        Auth <--> JSON[(ğŸ“„ JSON æ•°æ®åº“)]
        Inventory <--> JSON
        Workflow <--> JSON
        FileMgr <--> Disk[(ğŸ’¾ ç£ç›˜æ–‡ä»¶/å›¾ç‰‡)]
    end
```

### 2. ğŸ§© æ ¸å¿ƒæ•°æ®æ¨¡å‹ (ER Diagram)
ç³»ç»Ÿæ ¸å¿ƒå®ä½“å…³ç³»å¦‚ä¸‹ï¼Œå±•ç¤ºäº†ç”¨æˆ·ã€éƒ¨é—¨ã€ç‰©èµ„ä¸å€Ÿè¿˜æµç¨‹çš„å…³è”ã€‚

```mermaid
erDiagram
    DEPARTMENT ||--|{ USER : "æ‰€å±"
    USER ||--o{ BORROW_APPLICATION : "ç”³è¯·"
    USER ||--o{ APPROVAL_LOG : "å®¡æ‰¹æ“ä½œ"
    
    CATEGORY ||--|{ ITEM : "åˆ†ç±»"
    ITEM ||--o{ BORROW_APPLICATION : "è¢«å€Ÿç”¨"
    
    BORROW_APPLICATION ||--|| APPROVAL_PROCESS : "è§¦å‘"
    APPROVAL_PROCESS ||--|{ APPROVAL_LOG : "åŒ…å«"

    USER {
        string id PK
        string username
        string role "SuperAdmin/Admin/User"
    }
    ITEM {
        string id PK
        string name
        string status "Available/Borrowed/Maintenance"
    }
```

### 3. ğŸ”„ ç‰©èµ„å…¨ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æœº (Lifecycle)
ç‰©èµ„ä»å½•å…¥åˆ°æŠ¥åºŸçš„å…¨æµç¨‹çŠ¶æ€æµè½¬é€»è¾‘ã€‚

```mermaid
stateDiagram-v2
    [*] --> Available: âœ¨ æ–°è´­å½•å…¥
    
    state "åº“å­˜ä¸­ (Available)" as Available
    state "å®¡æ‰¹ä¸­ (Pending)" as Pending
    state "å·²å€Ÿå‡º (Borrowed)" as Borrowed
    state "ç»´ä¿®ä¸­ (Maintenance)" as Maintenance
    
    Available --> Pending: ğŸ“ ç”¨æˆ·ç”³è¯·å€Ÿç”¨
    Pending --> Borrowed: âœ… å®¡æ‰¹é€šè¿‡
    Pending --> Available: âŒ å®¡æ‰¹æ‹’ç»/æ’¤é”€
    
    Borrowed --> Available: ğŸ”™ å½’è¿˜ç¡®è®¤
    
    Available --> Maintenance: ğŸ”§ æŠ¥ä¿®
    Borrowed --> Maintenance: ğŸ”§ æŸåæŠ¥ä¿®
    Maintenance --> Available: ğŸ› ï¸ ç»´ä¿®å®Œæˆ
    
    Available --> [*]: ğŸ—‘ï¸ æŠ¥åºŸ/ç§»é™¤
```

---

## ğŸ“… å¼€å‘è·¯çº¿ä¸è¿›åº¦ (Roadmap)

```mermaid
gantt
    title é¡¹ç›®é‡Œç¨‹ç¢‘ (Project Timeline)
    dateFormat  YYYY-MM-DD
    axisFormat  %Y-%m
    
    section âœ… ç¬¬ä¸€é˜¶æ®µ: MVP
    éœ€æ±‚åˆ†æ & åŸå‹è®¾è®¡       :done,    p1, 2025-06-01, 30d
    åç«¯æ ¸å¿ƒæœåŠ¡å¼€å‘          :done,    p2, after p1, 60d
    Android å®¢æˆ·ç«¯è”è°ƒ        :done,    p3, after p2, 45d
    Docker & CI/CD éƒ¨ç½²       :done,    p4, after p3, 15d
    
    section ğŸš§ ç¬¬äºŒé˜¶æ®µ: ä¼˜åŒ–
    é€šçŸ¥ç³»ç»Ÿä¸æŠ¥è¡¨            :active,  p5, 2025-12-01, 45d
    æ‰«ç å€Ÿè¿˜åŠŸèƒ½              :         p6, after p5, 30d
    
    section ğŸ”® ç¬¬ä¸‰é˜¶æ®µ: æ¼”è¿›
    Web ç®¡ç†ç«¯å¼€å‘            :         p7, 2026-03-01, 90d
    å¤šæ•°æ®åº“ä¸å¤šç§Ÿæˆ·æ”¯æŒ      :         p8, after p7, 60d
```

### âœ… ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒåŠŸèƒ½ MVP (Current)
- [x] **åŸºç¡€è®¾æ–½**: Docker å®¹å™¨åŒ–éƒ¨ç½²ã€GitHub Actions CI/CD
- [x] **ç”¨æˆ·ä½“ç³»**: JWT èº«ä»½è®¤è¯ã€RBAC è§’è‰²æƒé™æ§åˆ¶ (SuperAdmin, Admin, User)
- [x] **ç‰©èµ„ç®¡ç†**: ç‰©èµ„å¢åˆ æ”¹æŸ¥ã€å›¾ç‰‡ä¸Šä¼ ã€è‡ªå®šä¹‰åˆ†ç±»
- [x] **ä¸šåŠ¡æµç¨‹**: å€Ÿç”¨ç”³è¯·ã€å¤šçº§å®¡æ‰¹æµã€å½’è¿˜é—­ç¯
- [x] **æ•°æ®å­˜å‚¨**: åŸºäº JSON çš„æœ¬åœ°æ–‡ä»¶æ•°æ®åº“ (æ— éœ€å®‰è£… MySQL/Mongo)

### ğŸš§ ç¬¬äºŒé˜¶æ®µï¼šä½“éªŒä¼˜åŒ– (In Progress)
- [ ] **é€šçŸ¥ç³»ç»Ÿ**: å®¡æ‰¹çŠ¶æ€å˜æ›´é‚®ä»¶/æ¶ˆæ¯æ¨é€
- [ ] **æ•°æ®æŠ¥è¡¨**: éƒ¨é—¨å€Ÿç”¨ç»Ÿè®¡å›¾è¡¨ã€ç‰©èµ„åˆ©ç”¨ç‡åˆ†æ
- [ ] **ç§»åŠ¨ç«¯å‡çº§**: æ”¯æŒæ‰«ç  (QR Code) å¿«é€Ÿå€Ÿè¿˜

### ğŸ”® ç¬¬ä¸‰é˜¶æ®µï¼šä¼ä¸šçº§æ¼”è¿› (Future)
- [ ] **Web ç®¡ç†ç«¯**: åŸºäº React/Vue çš„æ¡Œé¢ç«¯ç®¡ç†å¤§å±
- [ ] **æ•°æ®åº“è¿ç§»**: æ”¯æŒ SQLite/PostgreSQL æ’ä»¶åŒ–åˆ‡æ¢
- [ ] **å¤šç§Ÿæˆ·æ”¯æŒ**: æ”¯æŒå¤šç»„ç»‡/å¤šå…¬å¸éš”ç¦»éƒ¨ç½²

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆæ„æˆ (Tech Stack)

| é¢†åŸŸ | æŠ€æœ¯/å·¥å…· | è¯´æ˜ |
| :--- | :--- | :--- |
| **ç§»åŠ¨ç«¯** | **Android (Kotlin)** | Jetpack Compose / XML, Retrofit, Coroutines |
| **åç«¯** | **Node.js (TypeScript)** | Express, Multer, JSON Web Token |
| **å­˜å‚¨** | **LowDB / JSON** | è½»é‡çº§æœ¬åœ°æ–‡ä»¶å­˜å‚¨ï¼Œè‡ªåŠ¨å¤‡ä»½ |
| **è¿ç»´** | **Docker** | å®¹å™¨åŒ–å°è£…ï¼Œæ”¯æŒ docker-compose ä¸€é”®éƒ¨ç½² |
| **CI/CD** | **GitHub Actions** | è‡ªåŠ¨åŒ–æ„å»ºä¸ Docker Hub æ¨é€ |

---

## ğŸ“‚ ç›®å½•ç»“æ„æ·±åº¦è§£æ

> **è¯´æ˜**ï¼šæœ¬ä»“åº“ä¸»è¦åŒ…å« Android å®¢æˆ·ç«¯ä»£ç åŠé¡¹ç›®æ–‡æ¡£ã€‚åç«¯æœåŠ¡å™¨ä»£ç è¯·è®¿é—®ç‹¬ç«‹ä»“åº“ï¼š[HF-CYGG-equiptrack-server](https://github.com/HF-CYGG/HF-CYGG-equiptrack-server)ã€‚

```text
studio-main/
â”œâ”€â”€ android/              # Android å®¢æˆ·ç«¯åŸç”Ÿå·¥ç¨‹
â”‚   â”œâ”€â”€ app/              # æ ¸å¿ƒåº”ç”¨æ¨¡å—
â”‚   â””â”€â”€ build.gradle      # Gradle æ„å»ºé…ç½®
â”œâ”€â”€ server/               # åç«¯æœåŠ¡å™¨å·¥ç¨‹
â”‚   â”œâ”€â”€ src/              # TypeScript æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ config/       # ç¯å¢ƒå˜é‡ä¸ç³»ç»Ÿé…ç½®
â”‚   â”‚   â”œâ”€â”€ middlewares/  # è®¤è¯ã€ä¸Šä¼ ã€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ models/       # TypeScript ç±»å‹å®šä¹‰ä¸æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/       # API è·¯ç”±åˆ†å‘
â”‚   â”‚   â”œâ”€â”€ services/     # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (Service Layer)
â”‚   â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•° (æ•°æ®æŒä¹…åŒ–ç­‰)
â”‚   â”‚   â”œâ”€â”€ app.ts        # Express åº”ç”¨å®ä¾‹é…ç½®
â”‚   â”‚   â””â”€â”€ index.ts      # æœåŠ¡å™¨å¯åŠ¨å…¥å£
â”‚   â”œâ”€â”€ data/             # (è¿è¡Œæ—¶ç”Ÿæˆ) æœ¬åœ° JSON æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ uploads/          # (è¿è¡Œæ—¶ç”Ÿæˆ) å›¾ç‰‡ä¸Šä¼ å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ Dockerfile        # Docker å®¹å™¨æ„å»ºæè¿°æ–‡ä»¶
â”‚   â””â”€â”€ package.json      # Node.js ä¾èµ–ç®¡ç†
â””â”€â”€ API_SPEC.md           # è¯¦ç»†çš„ RESTful API æ¥å£æ–‡æ¡£
```

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è¯¦æƒ…

### 1. ğŸ‘® ç”¨æˆ·ä¸æƒé™ç®¡ç†
*   **å¤šè§’è‰²ä½“ç³»**ï¼š
    *   **è¶…çº§ç®¡ç†å‘˜**: å…¨å±€æŒæ§ï¼Œç®¡ç†æ‰€æœ‰éƒ¨é—¨ä¸å®¡æ‰¹ã€‚
    *   **éƒ¨é—¨ç®¡ç†å‘˜**: ä»…ç®¡ç†æœ¬éƒ¨é—¨ç‰©èµ„ä¸äººå‘˜ã€‚
    *   **æ™®é€šç”¨æˆ·**: è‡ªåŠ©æŸ¥è¯¢ä¸å€Ÿç”¨ã€‚
*   **æ³¨å†Œå®¡æ‰¹**: é‚€è¯·ç æœºåˆ¶ + ç®¡ç†å‘˜äººå·¥å®¡æ ¸ï¼Œç¡®ä¿å†…éƒ¨å®‰å…¨ã€‚

### 2. ğŸ“¦ ç‰©èµ„æ•°å­—åŒ–ç®¡ç†
*   **æ¡£æ¡ˆç®¡ç†**: å®Œæ•´è®°å½•ç‰©èµ„å‚æ•°ã€è´­ä¹°æ—¥æœŸã€ä¿ä¿®çŠ¶æ€ã€‚
*   **çŠ¶æ€è¿½è¸ª**: å®æ—¶å‘ˆç°ç‰©èµ„æµè½¬çŠ¶æ€ï¼ˆå€Ÿå‡ºäººã€å½’è¿˜æ—¶é—´ï¼‰ã€‚
*   **å¯è§†åŒ–**: æ”¯æŒå¤šå›¾ä¸Šä¼ ï¼Œç›´è§‚å±•ç¤ºç‰©èµ„å¤–è§‚ã€‚

### 3. ğŸ”„ æ™ºèƒ½å®¡æ‰¹æµ
*   **è‡ªåŠ¨è·¯ç”±**: æ ¹æ®ç”³è¯·äººæ‰€å±éƒ¨é—¨ï¼Œè‡ªåŠ¨å°†å®¡æ‰¹ä»»åŠ¡æ¨é€åˆ°å¯¹åº”ç®¡ç†å‘˜ã€‚
*   **å®Œæ•´æ—¥å¿—**: è®°å½•æ¯ä¸€æ­¥å®¡æ‰¹æ“ä½œçš„æ—¶é—´ã€äººå‘˜å’Œå¤‡æ³¨ã€‚

---

## ğŸš€ åç«¯éƒ¨ç½²æŒ‡å— (Server Deployment)

### ç¯å¢ƒå‡†å¤‡
*   **è¿è¡Œç¯å¢ƒ**: Node.js v18+
*   **åŒ…ç®¡ç†å™¨**: npm æˆ– yarn

### æ–¹å¼ä¸€ï¼šDocker å®¹å™¨åŒ–éƒ¨ç½² (å¼ºçƒˆæ¨è)

æœ¬é¡¹ç›®å·²æ·±åº¦ä¼˜åŒ– Docker æ”¯æŒï¼Œé›†æˆå›½å†…é•œåƒæºåŠ é€Ÿæ„å»ºã€‚

1.  **æ„å»ºé•œåƒ**
    ```bash
    # åœ¨ server ç›®å½•ä¸‹æ‰§è¡Œ
    docker build -t equiptrack-server .
    ```

2.  **å¯åŠ¨å®¹å™¨** (åŒ…å«æ•°æ®æŒä¹…åŒ–æŒ‚è½½)
    ```bash
    docker run -d \
      --name equiptrack-server \
      --restart always \
      -p 3000:3000 \
      -e TZ=Asia/Shanghai \
      -v /opt/equiptrack/data:/app/data \
      -v /opt/equiptrack/uploads:/app/uploads \
      yemiao351/equiptrack-server:latest
    ```

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘è¿è¡Œ

1.  **å®‰è£…ä¾èµ–**
    ```bash
    cd server
    npm install
    # å›½å†…æ¨è: npm config set registry https://registry.npmmirror.com
    ```

2.  **å¯åŠ¨æœåŠ¡**
    ```bash
    npm run dev   # å¼€å‘æ¨¡å¼
    npm run build && npm start # ç”Ÿäº§æ¨¡å¼
    ```

---

## ğŸ“± Android å®¢æˆ·ç«¯å¼€å‘æŒ‡å—

1.  **å·¥å…·**: Android Studio (Koala+)
2.  **è¿è¡Œ**: å¯¼å…¥ `android` ç›®å½•ï¼ŒSync Gradleï¼Œè¿æ¥çœŸæœºè¿è¡Œã€‚
3.  **é…ç½®**: ä¿®æ”¹ `BASE_URL` æŒ‡å‘ä½ çš„æœåŠ¡å™¨ IP (å¦‚ `http://192.168.1.100:3000/api/`)ã€‚

---

## ğŸ¤ è´¡çŒ®ä¸æ”¯æŒ

æ¬¢è¿æäº¤ Issue æˆ– Pull Request æ¥æ”¹è¿›æœ¬é¡¹ç›®ã€‚

*   **API æ–‡æ¡£**: [API_SPEC.md](./API_SPEC.md)
*   **ç»´æŠ¤è€…**: EquipTrack Team
